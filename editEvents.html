<!DOCTYPE html>
<html lang="en">

<head>
  <title>Edit Events</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link href="https://fonts.googleapis.com/css?family=Work+Sans:100,200,300,400,500,600,700,800" rel="stylesheet">

  <link rel="stylesheet" href="css/open-iconic-bootstrap.min.css">
  <link rel="stylesheet" href="css/animate.css">

  <link rel="stylesheet" href="css/owl.carousel.min.css">
  <link rel="stylesheet" href="css/owl.theme.default.min.css">
  <link rel="stylesheet" href="css/magnific-popup.css">

  <link rel="stylesheet" href="css/aos.css">

  <link rel="stylesheet" href="css/ionicons.min.css">

  <link rel="stylesheet" href="css/bootstrap-datepicker.css">
  <link rel="stylesheet" href="css/jquery.timepicker.css">


  <link rel="stylesheet" href="css/flaticon.css">
  <link rel="stylesheet" href="css/icomoon.css">
  <link rel="stylesheet" href="css/style.css">
    <script src='js/preload.js'></script>
</head>

<body>

  <nav class="navbar navbar-expand-lg navbar-dark ftco_navbar bg-dark ftco-navbar-light" id="ftco-navbar">
    <div class="container">
      <a class="navbar-brand" href="index.html"><i class="flaticon-cross"></i> <span>HPF</span> <span>Church</span></a>
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#ftco-nav" aria-controls="ftco-nav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="oi oi-menu"></span> Menu
      </button>
      <script type="text/javascript">
        function resetNavItem(element) {
          navArr = document.getElementsByClassName('nav-item')
          navArr = Object.entries(navArr)
          navArr.forEach(function(elem) {
            elem[1].className = 'nav-item smoothscroll'
          })
          classNavActive = 'nav-item smoothscroll active'
          element.parentElement.className = classNavActive;
        }
        var str = 'hell\"o'
      </script>
      <div class="collapse navbar-collapse" id="ftco-nav">
        <ul class="navbar-nav ml-auto">
          <li class="nav-item active"><a href="/#home" class="nav-link smoothscroll" onclick='javascript:resetNavItem(this);'>Home</a></li>
          <li class="nav-item"><a href="/" class="nav-link smoothscroll" onclick='javascript:resetNavItem(this);'>Our Mission</a></li>
          <li class="nav-item"><a href="/#connected" class="nav-link smoothscroll" onclick='javascript:resetNavItem(this);'>Get Connected</a></li>
          <li class="nav-item"><a href="/#sermonsAn" class="nav-link smoothscroll" onclick='javascript:resetNavItem(this);'>Sermons</a></li>
          <li class="nav-item"><a href="/#testimony" class="nav-link smoothscroll" onclick='javascript:resetNavItem(this);'>Testimonies</a></li>
          <li class="nav-item"><a href="/#section-counter" class="nav-link smoothscroll" onclick='javascript:resetNavItem(this);'>Achievements</a></li>
          <li class="nav-item"><a href="/#events" class="nav-link smoothscroll" onclick='javascript:resetNavItem(this);'>Events</a></li>
          <li class="nav-item"><a href="/#news" class="nav-link smoothscroll" onclick='javascript:resetNavItem(this);'>Newsletter</a></li>
          <li class="nav-item"><a href="/" class="nav-link smoothscroll" onclick='javascript:resetNavItem(this);'>Contact</a></li>
        </ul>
      </div>
    </div>
  </nav>
  <!-- END nav -->
  <!-- END nav -->

  <section id="home" class="video-hero js-fullheight" style="height: 700px; background-image: url(images/bg_1.jpg);  background-size:cover; background-position: center center;background-attachment:fixed;" data-section="home">
    <div class="overlay js-fullheight"></div>
    <div class="container">
      <div class="row no-gutters slider-text js-fullheight align-items-center justify-content-center" data-scrollax-parent="true">
        <div class="col-md-10 ftco-animate text-center" data-scrollax=" properties: { translateY: '70%' }">
          <p class="breadcrumbs mb-2" data-scrollax="properties: { translateY: '30%', opacity: 1.6 }"><span class="mr-2"><a href="index.html">Home</a></span> <span>Edit Events</span></p>
          <h1 class="mb-3 mt-0 bread" data-scrollax="properties: { translateY: '30%', opacity: 1.6 }">Edit Events!</h1>
        </div>
      </div>
    </div>
  </section>

  <section class="ftco-section contact-section ftco-degree-bg">
    <div class="container bg-light">
      <div class="row d-flex mb-5 contact-info">
        <div class="col-md-12 mb-4">
          <h2 class="h4">Edit the Events</h2>
        </div>
        <div class="w-100"></div>
        <div class="col-md-12">
          <p><span>Please Edit the Information. Events can be dragged to rearrange.</span> If events don't update, ensure the password is entered in correctly</p>
        </div>
      </div>
      <div class="row block-9">
        <div class="col-md-12 pr-md-5">
          <form action="javascript:submitEvents();">
            <div class="form-group" >
              <input id='password' type="password" class="form-control" placeholder="Password" name='pass' required>
            </div>
            <div class=row>
              <h2 class="col-md-3">
              Date
            </h2>
            <h2 class="col-md-3">
            Time
          </h2>
          <h2 class="col-md-3">
          Title
        </h2>
        <h2 class="col-md-3">
        Description
      </h2>
            <div id="containerInputs">
              <script type="text/javascript">
              function submitEvents(){
                ret = []
                  var containerInputs = document.getElementById('containerInputs')
                  arrFG = containerInputs.children
                  arrFG = Object.entries(arrFG)
                  console.log(arrFG)
                  arrFG.forEach(function(fg){
                      fg = fg[1]
                      if(fg.tagName == 'DIV')
                      {
                        event = new Object();
                        event.date = fg.children[0].children[0].value;
                        event.time = fg.children[1].children[0].value;
                        event.title = fg.children[2].children[0].value;
                        event.description = fg.children[3].children[0].value;
                        ret.push(event)
                      }
                  })
                  jsonret = JSON.stringify(ret)
                  pass = document.getElementById('password').value
                  url = 'https://script.google.com/macros/s/AKfycby8q58J1CIAXp-lhWNhAkiOzTE4_v_Xy1D8YVLt4C3tUe_-7hA/exec'
                  //fetch(url + "?pass="+pass+"&json="+jsonret,{method:'GET', 'mode': 'no-cors'})
                  window.location.href = url + "?pass="+pass+"&json="+jsonret;

              }
                function makeEvent(date, time, title, description){
                  var containerInputs = document.getElementById('containerInputs')
                  row = document.createElement('div')
                  row.className = 'row border border-primary'
                  arrFormGroup = [];
                  for(var i = 0; i<4; i++){
                    formGroup = document.createElement('div')
                    formGroup.className = 'form-group col-md-3'
                    arrFormGroup.push(formGroup)
                  }
                  dateEle = document.createElement('input'); dateEle.setAttribute('type','text'); dateEle.setAttribute('class', 'form-control dateEventEdit'); dateEle.setAttribute('placeholder','Date'); dateEle.setAttribute('name','date'); dateEle.required = true;
                  if(date!=null)
                    dateEle.value = date
                  arrFormGroup[0].appendChild(dateEle)

                  timeEle = document.createElement('input'); timeEle.setAttribute('type','text'); timeEle.setAttribute('class', 'form-control dateTimeEdit'); timeEle.setAttribute('placeholder','Time'); timeEle.setAttribute('name','time'); timeEle.required = true;
                  if(time!=null)
                    timeEle.value = time
                  arrFormGroup[1].appendChild(timeEle)

                titleEle = document.createElement('input'); titleEle.setAttribute('type','text'); titleEle.setAttribute('class', 'form-control dateTitleEdit'); titleEle.setAttribute('placeholder','Title'); titleEle.setAttribute('name','title'); titleEle.required = true;
                    if(title!=null)
                      titleEle.value = title
                    arrFormGroup[2].appendChild(titleEle)

                    desEle = document.createElement('textarea'); desEle.setAttribute('type','text'); desEle.setAttribute('class', 'form-control dateDescriptionEdit'); desEle.setAttribute('placeholder','Description'); desEle.setAttribute('name','description'); desEle.required = true;
                    if(description!=null)
                      desEle.value = description
                    arrFormGroup[3].appendChild(desEle)

                    arrFormGroup.forEach(function(fg){
                      row.appendChild(fg)
                    })
                    btn = document.createElement('button')
                    btn.innerHTML = "DELETE"
                    btn.setAttribute('onclick', 'this.parentNode.parentNode.removeChild(this.parentNode)')
                    btn.setAttribute('type','button')
                    btn.className = "delBtn btn btn-outline-secondary"
                      row.appendChild(btn)
                    containerInputs.appendChild(row)

                }
                var id = '1HCHkSZ3wquAG5joULORvHRLPmauRiMogqycWYnFiVls'
                var url = "https://spreadsheets.google.com/feeds/cells/" + id + "/default/public/basic?alt=json&min-row=1&min-col=1&max-col=4";
                fetch(url)
                  .then(function(response) {
                    return response.json();
                  })
                  .then(function(myJson) {
                    console.log(myJson);
                    entryArrays = myJson.feed.entry;
                    ite = 0;
                    entryArrays.forEach(function(entry) {
                      if (ite % 4 == 0 && ite >= 4) {
                        date = entry.content['$t'];
                        time = entryArrays[ite + 1].content['$t'];
                        title = entryArrays[ite + 2].content['$t'];
                        description = entryArrays[ite + 3].content['$t'];
                        makeEvent(date, time, title, description)
                      }
                      ite++

                    })

                  })


              </script>
            </div>
            <div class="form-group col-md-12">
              <input type="submit" value="Save"  class="btn btn-primary py-3 px-5">
              <input type="button" value="New Event" onclick="makeEvent(null,null,null,null)" style="float:right" class="btn btn-primary py-3 px-5">
            </div>
          </form>

        </div>
      </div>
    </div>
  </section>

  <footer class="ftco-footer ftco-bg-dark ftco-section">
    <div class="container">

      <div class="row">
        <div class="col-md-12 text-center">

          <p>
            <!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
            Copyright &copy;<script>
              document.write(new Date().getFullYear());
            </script> All rights reserved | HPF Dallas Church </p>
          <p style="display:none;">This template is made with <i class="icon-heart" aria-hidden="true"></i> by <a href="https://colorlib.com" target="_blank">Colorlib</a>
            <!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
          </p>
        </div>
      </div>
    </div>
  </footer>



  <!-- loader -->
  <div id="ftco-loader" class="show fullscreen"><svg class="circular" width="48px" height="48px">
      <circle class="path-bg" cx="24" cy="24" r="22" fill="none" stroke-width="4" stroke="#eeeeee" />
      <circle class="path" cx="24" cy="24" r="22" fill="none" stroke-width="4" stroke-miterlimit="10" stroke="#F96D00" /></svg></div>


  <script src="js/jquery.min.js"></script>
  <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
  <script type="text/javascript">
  $( function() {
  $( "#containerInputs" ).sortable({
    axis: "y",
     revert: true,
     scroll: false,
     cursor: "move"

  });
  } );
  </script>
  <script src="js/jquery-migrate-3.0.1.min.js"></script>
  <script src="js/popper.min.js"></script>
  <script src="js/bootstrap.min.js"></script>
  <script src="js/jquery.easing.1.3.js"></script>
  <script src="js/jquery.waypoints.min.js"></script>
  <script src="js/jquery.stellar.min.js"></script>
  <script src="js/owl.carousel.min.js"></script>
  <script src="js/jquery.magnific-popup.min.js"></script>
  <script src="js/aos.js"></script>
  <script src="js/jquery.animateNumber.min.js"></script>
  <script src="js/bootstrap-datepicker.js"></script>
  <script src="js/jquery.timepicker.min.js"></script>
  <script src="js/jquery.mb.YTPlayer.min.js"></script>
  <script src="js/scrollax.min.js"></script>
  <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBVWaKrjvy3MaE7SQ74_uJiULgl1JY0H2s&sensor=false"></script>
  <script src="js/google-map.js"></script>
  <script src="js/main.js"></script>
  <script src="js/custom_background.js"></script>
  <script type="text/javascript">
    //Custom js that uses slector to add backgrounf
    start_background("#home");
  </script>

</body>

</html>
